<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>바보상자 • 이미지호스팅</title>
    <link rel="shortcut icon" href="https://i.ibb.co/80mBhw1/003-5.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR:wght@200&display=swap"
      rel="stylesheet"
    />
    <style>
      .themeFont {
        font-family: "IBM Plex Sans KR", sans-serif;
        font-weight: bold;
        font-style: normal;
      }
      body {
        margin: 0;
        padding: 0;
        font-family: "IBM Plex Sans KR", sans-serif;
      }

      div,
      span {
        transition: all 0.2s ease;
      }

      #header {
        display: flex;
        width: 95%;
        height: 70px;
        margin: 1% auto;
        position: relative;
        justify-content: center;
        align-items: center;
      }

      #logo {
        display: flex;
        width: 70px;
        height: 70px;
        margin-right: auto;
      }

      #menu {
        display: flex;
        width: auto;
        height: 70px;
        margin-left: auto;
        justify-content: center;
        align-items: center;
      }

      #m-header-menubutton {
        display: none;
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
      }

      .header-button-cover {
        margin: 0 5px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      button,
      label {
        height: 40px;
        width: 100px;
        border-radius: 10px;
        border: none;
        transition: all 0.7s ease;
        font-size: 16px;
      }

      .button-low {
        background-color: #ffffff;
        color: #333333;
        box-sizing: border-box;
      }

      .button-mid {
        background-color: #333333;
        color: #ffffff;
      }

      .button-low:hover {
        box-shadow: inset 0px 0px 10px rgba(200, 200, 200, 0.5);
        border: 3px solid rgba(220, 220, 220, 0.7);
        border-radius: 20px;
      }

      .button-mid:hover {
        border: 3px solid rgba(100, 100, 100, 0.7);
        background-color: rgba(50, 50, 50, 0.8);
        border-radius: 15px;
      }

      #m-header-menu {
        position: fixed;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1;
        display: none;
        justify-content: center;
        align-items: center;
        backdrop-filter: blur(4px);
      }

      #m-header-menu-cover {
        position: absolute;
        width: 130px;
        border-radius: 10px;
        padding: 10px;
        background-color: #ffffff;
        z-index: 2;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        box-shadow: 0px 0px 10px gray;
        opacity: 1;
        right: 10px;
        top: 10px;
      }

      .header-button-cover {
        margin-bottom: 10px;
        width: 100%;
      }

      @media (max-width: 768px) {
        #header {
          flex-direction: column;
          align-items: center;
        }

        #menu {
          flex-direction: column;
          width: 100%;
          align-items: center;
          display: none;
        }

        #m-header-menubutton {
          display: flex;
          padding: 7px;
        }
      }

      #m-header-menubutton:hover {
        box-shadow: inset 0px 0px 10px rgba(200, 200, 200, 1);
        border-radius: 20px;
      }

      #bodyer {
        text-align: center;
        padding: 20px;
      }

      .highlight {
        font-weight: 400;
        color: #ff9934;
      }

      .card {
        position: absolute;
        right: 2%;
      }

      .card:nth-child(odd) {
        left: 2%;
      }

      .file-upload {
        display: inline-block;
        position: relative;
      }

      .file-upload input[type="file"] {
        position: absolute;
        opacity: 0;
        width: 100%;
        height: 100%;
        cursor: pointer;
      }

      #imagePreview {
        display: none;
        width: 200px;
        margin-top: 10px;
        border-radius: 10px;
        box-shadow: 0px 0px 5px #00000040;
      }

      #result {
        width: 300px;
        border-radius: 10px;
        padding: 5px;
        box-shadow: inset 0px 0px 2px #00000040;
        display: none;
        height: auto;
        overflow-wrap: break-word;
        word-wrap: break-word;
        padding: 10px;
        text-align: left;
        margin-top: 10px;
        position: relative;
      }

        .particle {
          position: absolute;
          border-radius: 5px;
          pointer-events: none;
          opacity: 1;
          transition: opacity 0.8s ease;
          width: 5px;
          height: 5px;
          background-color: rgba(255, 255, 255, 0.8);
          animation: explosion 1s
            /*cubic-bezier(0.68, -0.55, 0.27, 1.55);*/
        }

        @keyframes explosion {
          0% {
            transform: translate(0, 0) scale(1) rotate(0deg);
            opacity: 1;
          }

          50% {
            transform: translate(var(--offsetX), var(--offsetY)) scale(1.2) rotate(180deg);
            opacity: 0.7;
          }

          100% {
            transform: translate(calc(var(--offsetX) * 1.5), calc(var(--offsetY) * 1.5)) scale(0.5) rotate(360deg);
            opacity: 0;
          }
        }
    </style>
  </head>

  <body>
    <div id="header">
      <span id="logo"
        ><img
          src="https://ifh.cc/g/s2VbZZ.png"
          width="70px"
          height="70px"
          alt="Logo"
      /></span>
      <span id="menu">
        <span class="header-button-cover"
          ><button class="button-low" onclick="movePage('/aboutbot.html')">
            <div>소개</div>
          </button></span
        >
        <span class="header-button-cover"
          ><button class="button-low" onclick="movePage('/howtouse.html')">
            <div>공지</div>
          </button></span
        >
        <span class="header-button-cover"
          ><button class="button-low" onclick="movePage('/server.html')">
            <div>소통</div>
          </button></span
        >
        <span class="header-button-cover"
          ><button class="button-mid" onclick="window.location.href='/';">
            <div>+ 업로드</div>
          </button></span
        >
      </span>
      <span id="m-header-menubutton" onclick="mobileHeader();"
        ><img
          src="https://ifh.cc/g/NTSB1R.png"
          width="30px"
          height="30px"
          alt="Menu"
      /></span>
    </div>

    <div id="m-header-menu" onclick="mobileHeader();">
      <div id="m-header-menu-cover">
        <div class="header-button-cover">
          <button class="button-low" onclick="movePage('/aboutbot.html')">
            <div>소개</div>
          </button>
        </div>
        <div class="header-button-cover">
          <button class="button-low" onclick="movePage('/howtouse.html')">
            <div>공지</div>
          </button>
        </div>
        <div class="header-button-cover">
          <button class="button-low" onclick="movePage('/server.html')">
            <div>소통</div>
          </button>
        </div>
        <div class="header-button-cover">
          <button class="button-mid" onclick="window.location.href='/';">
            <div>+ 업로드</div>
          </button>
        </div>
      </div>
    </div>

    <hr style="width: 95%; border: 0.5px solid #7d7d7d" />

    <div id="bodyer">
      <div id="content">
        <h1>박영초 이미지 업로드</h1>
        <h4>당신의 놀라운 경험을 공유해보세요!</h4>
        <span
          ><h5>
            <a
              href="https://naver.me/xKQingLm"
              style="position: absolute; bottom: 10px; right: 10px"
            >
              개발자에 대하여</a
            >
          </h5></span
        >
        <h6>
          음란물 유포시 정보통신망 이용촉진 및 정보보호 등에 관한 법률
          (정보통신망법)에 의해 처벌될 수 있습니다.
          <span><a href="/rule">▶이용약관보기</a></span>
        </h6>
        <hr style="width: 25%; border: 0.5px solid #7d7d7d" />
        <div class="file-upload">
          <input type="file" id="imageInput" accept="image/*" required />
          <label for="imageInput">
            <button class="button-low" id="chooseFileButton">+ 파일찾기</button>
          </label>
        </div>
        <button class="button-mid" id="uploadSubmitButton">업로드</button>
        <center>
          <div id="imagePreviewContainer">
            <img id="imagePreview" src="" alt="미리보기" />
          </div>
        </center>
        <center>
          <div id="result">
            <div
              style="position: absolute; top: 5px; right: 5px"
              class="button-low"
              onclick="copyText(link);"
            >
              복사
            </div>
          </div>
        </center>
      </div>
    </div>

    <script>
      function copyText(text) {
        navigator.clipboard
          .writeText(text)
          .then(() => {
            alert("클립보드에 텍스트가 복사되었습니다!");
          })
          .catch((err) => {
            console.error("복사 실패: ", err);
          });
      }
      function mobileHeader() {
        const menu = document.getElementById("m-header-menu");
        menu.style.display =
          menu.style.display === "none" || menu.style.display === ""
            ? "flex"
            : "none";
      }

      function movePage(page) {
        window.alert("아직 개발중...");
      }

      const imageInput = document.getElementById("imageInput");
      const imagePreview = document.getElementById("imagePreview");

      imageInput.addEventListener("change", function () {
        const file = this.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function () {
            imagePreview.src = reader.result;
            imagePreview.style.display = "block";
          };
          reader.readAsDataURL(file);
        } else {
          imagePreview.src = "";
          imagePreview.style.display = "none";
        }
      });

      let link;
      const uploadSubmitButton = document.getElementById("uploadSubmitButton");
      uploadSubmitButton.addEventListener("click", () => {
        const file = imageInput.files[0];
        if (!file) {
          alert("업로드할 파일을 선택해주세요.");
          return;
        }

        const formData = new FormData();
        formData.append("image", file);

        fetch("/upload", {
          method: "POST",
          body: formData,
        })
          .then((response) => response.json())
          .then((data) => {
            link = data.link;
            console.log("suc");
            createFirework(mouse.x, mouse.y);document.getElementById("result").style.display = "block";
            document.getElementById("result").innerHTML =
              `<h4 style = "margin:3px;">이미지 링크</h4> <a href="${data.link}">${data.link}</a><div style = "position:absolute;top:5px;right:5px;margin:3px;font-weight:bold;" class="button-low" onclick="copyText(link);">복사</div>`;
          })
          .catch((error) => {
            console.error("Error:", error);
            alert("업로드 중 문제가 발생했습니다. 다시 시도해주세요.");
          });
      });

      function createFirework(x, y) {
        const colors = ["#ff0044", "#ff6600", "#ffcc00", "#33cc33", "#3399ff"];
        const numParticles = 50;
        const explosionRadius = 150;

        const fireworkContainer = document.createElement("div");
        fireworkContainer.style.position = "absolute";
        fireworkContainer.style.top = 0;
        fireworkContainer.style.left = 0;
        document.body.appendChild(fireworkContainer);

        for (let i = 0; i < numParticles; i++) {
          const particle = document.createElement("div");
          const size = Math.random() * 10 + 3;
          const color = colors[Math.floor(Math.random() * colors.length)];

          const angle = Math.random() * 2 * Math.PI;
          const distance = Math.random() * explosionRadius;
          const offsetX = distance * Math.cos(angle);
          const offsetY = distance * Math.sin(angle);

          particle.className = "particle";
          particle.style.width = `${size}px`;
          particle.style.height = `${size}px`;
          particle.style.backgroundColor = color;
          particle.style.left = `${x - size / 2}px`;
          particle.style.top = `${y - size / 2}px`;
          particle.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
          particle.style.setProperty("--offsetX", `${offsetX}px`);
          particle.style.setProperty("--offsetY", `${offsetY}px`);
          particle.style.animation = "explosion 1s forwards";

          fireworkContainer.appendChild(particle);

          particle.addEventListener("animationend", () => {
            particle.remove();
            if (fireworkContainer.children.length === 0) {
              fireworkContainer.remove();
            }
          });
        }
      }

        let mouse = {x: window.innerWidth / 2, y: window.innerHeight / 2};

        document.addEventListener('click', (event) => {
          mouse.x = event.clientX;
          mouse.y = event.clientY;
        });

    </script>
  </body>
</html>
